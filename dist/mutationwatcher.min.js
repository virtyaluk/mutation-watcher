/** 
 * mutation-watcher 1.0.2 
 * https://github.com/virtyaluk/mutation-watcher 
 * 
 * Copyright (c) 2015 Bohdan Shtepan 
 * Licensed under the MIT license. 
 */


!function(a,b){"use strict";"function"==typeof define&&define.amd?define(function(){return b(a)}):"undefined"!=typeof module?module.exports=b(a):a.MutationWatcher=b(a)}(this,function(a){"use strict";var b,c=a.Element.prototype,d=Array.isArray,e=a.MutationObserver||a.WebKitMutationObserver||a.MozMutationObserver,f=c.matches||c.webkitMatchesSelector||c.mozMatchesSelector||c.msMatchesSelector||c.oMatchesSelector||c.matchesSelector,g=function(a){return"object"==typeof a&&null!==a},h=function(a){return!!(a&&a.constructor&&a.call&&a.apply)},i=function(){return[].filter.call(arguments,function(a){return d(a)})[0]},j=function(a){return"undefined"==typeof a},k={attributes:"attribute-change",elements:"element-change",characterData:"characterdata-change"},l=function(b,c,d){var e;try{e=new a.CustomEvent(c,{detail:d})}catch(b){e=a.document.createEvent("CustomEvent"),e.initCustomEvent(c,!0,!0,d)}b.dispatchEvent(e)},m=function(a){var b={},c=["target","attributeName","attributeNameNamespace","oldValue","newValue","attributeChange","relatedNode","addedNodes","removedNodes","previousSibling","nextSibling","type"];return c.forEach(function(c){b[c]=a[c]||null}),"DOMAttrModified"===a.type?(b.type="attributes",b.attributeName=a.attrName,b.oldValue=a.prevValue,b.attributeChange=a.attrChange):"DOMCharacterDataModified"===a.type?(b.type="characterData",b.oldValue=a.prevValue):("DOMNodeInserted"===a.type||"DOMNodeRemoved"===a.type)&&(b.type="elements",b.target=a.relatedNode,"DOMNodeInserted"===a.type?b.addedNodes=[a.target]:b.removedNodes=[a.target],b.nextSibling=a.target.nextSibling||null,b.previousSibling=a.target.previousSibling||null),b},n=function(a,b){return a&&b?!![].filter.call(a,function(a){return"string"==typeof a?f.call(b,a):b===a}).length:!1},o=function(a){var c,d=this,e=m(a);e.type="childList"===e.type?"elements":e.type,d._config.attributes&&"attributes"===e.type?(c=d._config.attributeFilter,c&&c.length&&-1===c.indexOf(e.attributeName)&&(e=null)):d._config.childList&&"elements"===e.type?(c=d._config.matchElements,c&&c.length&&!n(c,(e.addedNodes||e.removedNodes)[0])&&(e=null)):d._config.characterData&&"characterData"===e.type?(e.newValue=e.target.data||e.target.nodeValue,e.data=e.target,e.target=e.data.parentNode,c=d._config.matchCharacterDataElements,c&&c.length&&!n(c,e.target)&&(e=null)):e=null,e&&!d._config.subtree&&"characterData"!==e.type&&e.target!==d._target&&(e=null),e&&(d.allowCustomEvents&&l(d._target,b.customEventsNames[e.type],e),d._callback&&d._callback(e,d),d._records.push(e))},p=function(){var a=[];return this._records&&(a=this._records.slice(0),this._records.splice(0,this._records.length)),a},q=function(a){var b=this;b._config={attributes:a.attributes||b.allowCustomEvents,childList:a.elements||b.allowCustomEvents,matchElements:a.matchElements,characterData:a.characterData||b.allowCustomEvents,subtree:a.subtree||b.allowCustomEvents,matchCharacterDataElements:a.matchCharacterDataElements},b._config.characterData&&a.characterDataOldValue&&!b.allowCustomEvents?b._config.characterDataOldValue=a.characterDataOldValue:b.allowCustomEvents&&(b._config.characterDataOldValue=!0),b._config.attributes&&a.attributeOldValue&&!b.allowCustomEvents?b._config.attributeOldValue=a.attributeOldValue:b.allowCustomEvents&&(b._config.attributeOldValue=!0),d(a.matchAttributes)&&(b._config.attributeFilter=a.matchAttributes)},r=function(b,c){var d=this,e=c||{all:!0,subtree:!1},f={elements:!1,matchElements:null,attributes:!1,matchAttributes:null,characterData:!1,subtree:!1,attributeOldValue:!0,characterDataOldValue:!0,matchCharacterDataElements:null};b instanceof a.Node?d._target=b:"string"==typeof b?d._target=a.document.querySelector(b):d._target=a.document,"all"===e||e.all?(f.attributes=f.elements=f.characterData=!0,f.subtree=!!e.subtree||!1):"string"==typeof e?(f.attributes="attributes"===e,f.elements="elements"===e,f.characterData="characterData"===e):g(e)&&(f.attributes=!!e.attributes,f.attributeOldValue=!!e.attributeOldValue||f.attributes,f.matchAttributes=i(e.attributes,e.matchAttributes),f.elements=!!e.elements,f.matchElements=i(e.elements,e.matchElements),f.characterData=!!e.characterData,f.characterDataOldValue=!!e.characterDataOldValue||f.characterData,f.matchCharacterDataElements=i(e.characterData,e.matchCharacterDataElements),f.subtree=!!e.subtree),q.call(d,f)},s=function(a,b){var c=this;return c._isObserving&&c.disconnect(),d(c._records)||(c._records=[]),c._getConfig(a,b),e?(c._mutationObserver=new e(function(a){a.forEach(c._publisher)}),c._mutationObserver.observe(c._target,c._config)):(c._config.attributes&&c._target.addEventListener("DOMAttrModified",c._publisher,!1),c._config.childList&&(c._target.addEventListener("DOMNodeInserted",c._publisher,!1),c._target.addEventListener("DOMNodeRemoved",c._publisher,!1)),c._config.characterData&&c._target.addEventListener("DOMCharacterDataModified",c._publisher,!1)),c._isObserving=!0,c},t=function(){return e&&this._mutationObserver?this._mutationObserver.disconnect():(this._target.removeEventListener("DOMAttrModified",this._publisher,!1),this._target.removeEventListener("DOMNodeInserted",this._publisher,!1),this._target.removeEventListener("DOMNodeRemoved",this._publisher,!1),this._target.removeEventListener("DOMCharacterDataModified",this._publisher,!1)),this._isObserving=!1,p.call(this)};return b=function(a,c){var d=this;return d instanceof b?(d._isObserving=!1,d._target=null,d._records=null,d._config=null,d._mutationObserver=null,d._callback=h(a)?a:null,d._publisher=o.bind(d),d.allowCustomEvents=j(c)?!(!j(a)&&null!==a):c,d):new b(a,c)},b.prototype._getConfig=r,b.prototype.watch=s,b.prototype.disconnect=t,b.prototype.takeRecords=p,b.customEventsNames=k,b});
//# sourceMappingURL=mutationwatcher.min.js.map